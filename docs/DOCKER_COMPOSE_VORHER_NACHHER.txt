â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        DOCKER-COMPOSE VORHER vs. NACHHER                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

VORHER (Alt - OHNE PowerManager):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

services:
  loxoneaudioserver:
    container_name: lox-audioserver
    image: ghcr.io/rudyberends/lox-audioserver:latest
    hostname: lox-audioserver
    build:
      context: .
      dockerfile: ./Dockerfile
    restart: unless-stopped
    network_mode: host
    cap_add:
      - SYS_ADMIN
      - DAC_READ_SEARCH


    # âŒ KEIN devices!
    # âŒ KEIN environment fÃ¼r PowerManager!

    volumes:
      - ./data:/app/data


NACHHER (Neu - MIT PowerManager):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

services:
  loxoneaudioserver:
    container_name: lox-audioserver
    image: ghcr.io/rudyberends/lox-audioserver:latest
    hostname: lox-audioserver
    build:
      context: .
      dockerfile: ./Dockerfile
    restart: unless-stopped
    network_mode: host
    cap_add:
      - SYS_ADMIN
      - DAC_READ_SEARCH
    
    # âœ… NEU: USB Devices
    devices:
      - /dev/snd:/dev/snd
      - /dev/ttyUSB0:/dev/ttyUSB0
    
    # âœ… NEU: PowerManager Umgebungsvariablen
    environment:
      PM_ENABLED: "true"
      PM_USB_PORT: "/dev/ttyUSB0"
      PM_USB_BAUD_RATE: "9600"
      PM_CHANNEL: "1"
      PM_TURN_ON_AT_PLAY: "true"
      PM_TURN_OFF_DELAY: "5"

    volumes:
      - ./data:/app/data


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

UNTERSCHIEDE ZUSAMMENGEFASST:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€ HINZUGEFÃœGT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                â”‚
â”‚  1. devices Sektion mit 2 Zeilen:                                             â”‚
â”‚     - /dev/snd:/dev/snd              (Soundkarte)                             â”‚
â”‚     - /dev/ttyUSB0:/dev/ttyUSB0      (USB Relais)                             â”‚
â”‚                                                                                â”‚
â”‚  2. environment Sektion mit 6 PowerManager Variablen:                          â”‚
â”‚     - PM_ENABLED: "true"                                                      â”‚
â”‚     - PM_USB_PORT: "/dev/ttyUSB0"                                              â”‚
â”‚     - PM_USB_BAUD_RATE: "9600"                                                â”‚
â”‚     - PM_CHANNEL: "1"                                                         â”‚
â”‚     - PM_TURN_ON_AT_PLAY: "true"                                              â”‚
â”‚     - PM_TURN_OFF_DELAY: "5"                                                  â”‚
â”‚                                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

COPY-PASTE VORLAGE (vollstÃ¤ndig):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Einfach die ganze Datei mit folgendem Inhalt ersetzen:

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

version: '3.8'

services:
  loxoneaudioserver:
    container_name: lox-audioserver
    image: ghcr.io/rudyberends/lox-audioserver:latest
    hostname: lox-audioserver
    build:
      context: .
      dockerfile: ./Dockerfile
    restart: unless-stopped
    network_mode: host
    cap_add:
      - SYS_ADMIN
      - DAC_READ_SEARCH
    
    devices:
      - /dev/snd:/dev/snd
      - /dev/ttyUSB0:/dev/ttyUSB0
    
    environment:
      PM_ENABLED: "true"
      PM_USB_PORT: "/dev/ttyUSB0"
      PM_USB_BAUD_RATE: "9600"
      PM_CHANNEL: "1"
      PM_TURN_ON_AT_PLAY: "true"
      PM_TURN_OFF_DELAY: "5"
    
    volumes:
      - ./data:/app/data

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

SCHRITT-FÃœR-SCHRITT ANPASSUNG:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1ï¸âƒ£  Datei Ã¶ffnen:
    $ cd lox-audioserver-beta
    $ code docker-compose.yml

2ï¸âƒ£  Nach Zeile "cap_add:" suchen (sollte Zeile ~14 sein)

3ï¸âƒ£  Nach den cap_add Zeilen folgendes EINFÃœGEN:
    
    (leere Zeile)
    devices:
      - /dev/snd:/dev/snd
      - /dev/ttyUSB0:/dev/ttyUSB0
    
    (leere Zeile)
    environment:
      PM_ENABLED: "true"
      PM_USB_PORT: "/dev/ttyUSB0"
      PM_USB_BAUD_RATE: "9600"
      PM_CHANNEL: "1"
      PM_TURN_ON_AT_PLAY: "true"
      PM_TURN_OFF_DELAY: "5"

4ï¸âƒ£  Speichern (Ctrl+S)

5ï¸âƒ£  Im Terminal:
    $ docker-compose up -d

6ï¸âƒ£  Logs Ã¼berprÃ¼fen:
    $ docker-compose logs -f lox-audioserver | grep -i power

7ï¸âƒ£  Sehen Sie diese Nachricht? Dann ist's richtig:
    [PowerManagement] USB Relais connected

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

WICHTIGE PUNKTE ZUM MERKEN:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… MUSS SO SEIN:
  â€¢ devices: (folgende Zeilen mit 2 Spaces einrÃ¼cken!)
  â€¢ environment: (folgende Zeilen mit 2 Spaces einrÃ¼cken!)
  â€¢ Alle Werte in AnfÃ¼hrungszeichen: "true", "9600", etc.
  â€¢ Keine Tabs! Nur Spaces!
  â€¢ Doppelpunkt nach dem SchlÃ¼ssel: PM_ENABLED:

âŒ HÃ„UFIGE FEHLER:
  â€¢ Falsche EinrÃ¼ckung â†’ docker-compose schlÃ¤gt fehl
  â€¢ Tabs statt Spaces â†’ YAML-Fehler
  â€¢ Fehlende AnfÃ¼hrungszeichen â†’ Parser-Error
  â€¢ Falscher Port: "ttyUSB0" statt "/dev/ttyUSB0" â†’ PowerManager findet GerÃ¤t nicht

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

QUICK-CHECK (haben Sie alles richtig gemacht?):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Nach docker-compose up -d kÃ¶nnen Sie prÃ¼fen:

  $ docker-compose logs -f

Erfolg Zeichen:
  âœ… "[PowerManagement] USB Relais connected"
  âœ… "Relay turned ON" (wenn Sie Musik spielen)
  âœ… "Relay turned OFF" (nach 5 Sekunden wenn Sie stoppen)

Fehler Zeichen:
  âŒ "Failed to initialize USB Relais" â†’ Port Ã¼berprÃ¼fen
  âŒ "docker-compose: YAML error" â†’ EinrÃ¼ckung Ã¼berprÃ¼fen
  âŒ "ENOENT" â†’ /dev/ttyUSB0 nicht vorhanden â†’ lsusb prÃ¼fen

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

FALLS NOCH FRAGEN AUFTAUCHEN:

1. Lesen Sie: docs/DOCKER_COMPOSE_ANPASSUNG.txt (diese Datei!)
2. Schauen Sie: docker-compose logs -f
3. PrÃ¼fen Sie: ls -la /dev/ttyUSB* (ist das Relais da?)

Fertig! ğŸ‰
